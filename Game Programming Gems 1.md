## 第一章 通用编程技术
![[Pasted image 20250525081413.png]]

### 神奇的数据驱动设计
> Author: Steve Rabin
> Contact: 

游戏由两部分组成：**逻辑和数据**，这是一种有效的划分。分开来，它们一点用处都没有，不过合在一起，它们就能让你的游戏充满生机。
逻辑部分定义游戏引擎的核心原则合算法，数据部分则提供其内容合行为的具体细节。当逻辑合数据互相分离开来，并能够独立发展，则会产生神奇的效果。
游戏数据应该从文件载入，而不是应该内嵌在代码中。如何适度把握其中的平衡是问题的关键。

#### 1 基础
创建一个能按需解析文本文件的系统。这对于数据驱动设计的有效应用来说至关重要。
文本文件如果只用作编辑修改是没有什么实际意义的，它的真正意义在于——不用修改一行代码，就可以进行各种新的尝试，并改变不同的东西来进行测试。
#### 2 最低标准
不要编码常量；把常量放进文本文件中，这样进行改变时就不需要重新编译代码了。如果处理得当，那么所有人都可以使用一下记事本就能够改变摄像机行为。
游戏设计者合制作者通常会受控于程序员，通过报复算法常量，那些非程序员们可以用各种值来进行调试以达到他们的确切行为，而不需要打扰任何一个程序员。
#### 3 杜绝硬编码
要假定任何东西都可能改变。如果游戏调用屏幕拆分，**不要用硬编码来实现**。只要采用正确的设计，并不会增加多少工作量就可以有一个可维护性的摄像机。
如果核心设计决策很灵活，游戏就可以逐渐演化，并在最终发挥其巨大的潜力。事实上，对游戏进行抽象，将核心部分抽象出来做好可扩展性花费不了多少功夫，并且能很大程度减少后续因为写死带来的麻烦。

#### 4 将控制流写成脚本
脚本只是一种在代码外定义行为的方法。脚本对于定义游戏中的步骤顺序或者需要触发的游戏事件非常有用。
脚本语言设计需要注意**分支命令**。分支有两种方法：
- 直接将变量保存在脚本语言中，并用数学运算符进行比较
- 直接调用独立存在于代码中用于比较变量的评价函数
对于上述两种方法，可以互相结合使用，但是**要确保脚本的简洁**
如果需要创建独一无二的脚本，你要需要对应的脚本语言以及用来解析脚本语言的脚本分析器，如果有必要的话，甚至还需要一个编译器来讲脚本转换成二进制文件以便快速执行。

#### 5 脚本不适用的情况
使用脚本编写数据驱动行为时使用数据驱动方法的必然后果。不过你需要记住数据驱动的核心思想：**将逻辑和数据分开，复杂的逻辑在代码中运行，数据则保留在外面**。
但是在某些情况下，在处理复杂的游戏逻辑时不得不将数据引入，导致生成十分复杂的脚本。
>为什么要把复杂逻辑保持在代码中？
>原因在于功能性和调试性方面的问题。由于·脚本不直接在代码中，它们需要重复很多编程语言中已有的概念。这种倾向的结果就是，让其拥有越来越多的功能，直到与真实的语言相媲美。但是脚本在变得复杂的同时，我们也需要更多的调试信息去找出脚本中的错误。

##### 模糊的边界
脚本的触发原则：如果逻辑太复杂，那么就应该放在代码中。脚本语言应该保持简洁，以便保证不会因为脚本的加载消耗太多的资源。
> 总之要记住，你不希望自己的游戏设计师或者脚本编写人员对游戏进行编程。有些时候，当程序员创建脚本语言时，他们会试图逃避责任。“引诱”游戏设计师对游戏编程实在是太容易了。

#### 6 避免重复的数据
绝对不要复制代码，这是一条编程实践标准。如果在两个不同的地方你需要用相同的行为，这个行为只能存在于一个地方。这种思想也可以应用于数据，可以采用因用来指向全局的数据块。甚至，通过使用引用指向数据块并修改其中的一些值，可以实现类似的继承的概念。

####  7 开发工具来生成数据
在大型游戏中，文本文件最终会变得不好控制和处理。实际的解决办法是**采用一个工具来写这个文本文件**。这种工具可以叫做游戏编辑器、关卡编辑器或者脚本编辑器。采用工具来写并不会改变数据驱动的思想，它只会使得数据驱动更加健壮、更加高效。

#### 8 结论
采用数据驱动方法很容易，但是得到显著的效果缺不容易。当所有的东西都采用数据驱动的时候，你将有无限种发展的可能。

### 1.1 面向对象的编程与设计技术
